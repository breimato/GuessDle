{% extends "base.html" %}

{% block title %}Ranking{% if game %} – {{ game.name }}{% endif %}{% endblock %}

{% block main_class %}
min-h-screen flex flex-col items-center
bg-no-repeat bg-cover bg-fixed
bg-[url('{% static "img/login.png" %}')]
py-10 px-4 gap-10
{% endblock %}

{% block content %}
<a href="{% url 'dashboard' %}"
   class="self-start text-yellow-300 hover:underline mb-4">
  ← Volver al panel
</a>

<h1 class="text-3xl font-bold text-center text-yellow-100 mb-8 drop-shadow">
  🏆 Ranking{% if game %} – {{ game.name }}{% else %} global{% endif %}
</h1>

<table class="w-full max-w-3xl text-sm gd-table">
  <thead>
    <tr class="gd-header">
      <th>#</th>
      <th>Jugador</th>
      <th>Media de intentos</th>
      <th>Partidas</th>
    </tr>
  </thead>
  <tbody>
    {% for row in stats %}
    <tr>
      <td class="gd-cell">{{ forloop.counter }}</td>
      <td class="gd-cell">{{ row.user__username }}</td>
      <td class="gd-cell">{{ row.avg_attempts|floatformat:2 }}</td>
      <td class="gd-cell">{{ row.games_played }}</td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="4" class="gd-cell">Aún no hay datos 😢</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% if not game %}
  <h2 class="text-xl text-center text-yellow-100 mt-12 mb-4 drop-shadow">
    Rankings por juego
  </h2>
  <div class="flex flex-wrap gap-4 justify-center">
    {% for g in games %}
      <a href="{% url 'ranking_game' g.slug %}"
         class="bg-yellow-700 text-white px-4 py-2 rounded hover:bg-yellow-800 transition shadow">
        {{ g.name }}
      </a>
    {% endfor %}
  </div>
{% endif %}
{% endblock %}
